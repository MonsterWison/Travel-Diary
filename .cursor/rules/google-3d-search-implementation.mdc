# Google Search 三維搜尋系統實施指南

## 核心概念

Google Search 的三維搜尋系統基於以下三個維度進行匹配：

### 1. 語意維度 (Semantic Dimension) - 50% 權重
- **同義詞擴展**：建立景點類型同義詞庫，包含 temple/shrine/monastery、museum/gallery/exhibition 等
- **主詞提取**：智能過濾停用詞，支援多語言（英文、中文、法文、西班牙文）
- **語意相似度計算**：結合 Jaccard 相似度、Levenshtein 距離、N-gram 匹配
- **多語言處理**：特別針對中文景點名稱的語意處理，處理地理後綴（泳灘、廣場、車站等）

### 2. 地理維度 (Geographic Dimension) - 40% 權重
- **非線性距離評分**：100m 內完美匹配(1.0)，500m 內高度匹配(0.95)，1km 內良好匹配(0.85)
- **景點類型距離容忍度**：機場/車站允許更大距離，商店/餐廳要求精確位置
- **城市/區域匹配加成**：同城市或區域的景點獲得額外加分
- **人口密度調整**：市中心距離容忍度較低，郊區較高

### 3. 類型/屬性維度 (Type/Attribute Dimension) - 10% 權重
- **12 大景點分類**：宗教、文化、娛樂、自然、交通、商業、歷史、教育、醫療、政府、體育、娛樂
- **相關類型匹配**：宗教類型可匹配歷史文化類型，文化類型可匹配教育類型
- **完全匹配優先**：同類型景點獲得最高分數(1.0)

## 動態智能調整

### 權重動態調整
```swift
// 根據查詢特徵調整權重
if query.contains("near") || query.contains("nearby") {
    weights = (semantic: 0.3, geographic: 0.6, type: 0.1)
} else if query.contains("type") || query.contains("kind") {
    weights = (semantic: 0.4, geographic: 0.3, type: 0.3)
} else if query.length > 30 {
    weights = (semantic: 0.6, geographic: 0.3, type: 0.1)
}
```

### 置信度門檻調整
```swift
// 根據查詢特徵調整置信度門檻
if query.contains("exact") || query.contains("specific") {
    threshold = 0.85  // 精確查詢需要更高置信度
} else if query.length < 10 {
    threshold = 0.6   // 短查詢降低門檻
} else {
    threshold = 0.7   // 預設門檻
}
```

## 實施原則

### 語意匹配優化
1. **主詞交集匹配**：≥2 個主詞交集直接通過（0.95 分）
2. **同義詞擴展**：建立完整的景點類型同義詞庫
3. **停用詞過濾**：過濾無意義詞彙，支援多語言
4. **N-gram 相似度**：3-gram 字符級別匹配處理拼寫變化

### 地理匹配優化
1. **非線性評分**：距離越近分數越高，但不是線性關係
2. **類型容忍度**：不同景點類型有不同的距離容忍度
3. **Haversine 公式**：精確計算地球表面兩點間距離

### 類型匹配優化
1. **完整分類體系**：涵蓋所有主要景點類型
2. **相關類型支援**：允許相關類型的部分匹配
3. **關鍵詞檢測**：通過名稱中的關鍵詞判斷類型

## 測試案例

### 案例 1：語意縮寫匹配
- 查詢：「Congregation Sherith Israel」
- 目標：「Shearith Israel」
- 預期：系統應識別宗教機構名稱的縮寫形式

### 案例 2：中文地理匹配
- 查詢：「銀線灣泳灘」
- 目標：「銀線灣」
- 預期：系統應理解中文地理後綴的語意關係

### 案例 3：同義詞類型匹配
- 查詢：「Buddhist Temple」
- 目標：「Man Mo Temple」
- 預期：系統應識別宗教類型的同義詞關係

## 性能指標

### 準確度目標
- 語意匹配準確度：≥90%
- 地理匹配精度：≥85%
- 類型識別準確度：≥95%
- 整體匹配準確度：≥88%

### 性能要求
- 匹配速度：O(n) 線性複雜度
- 記憶體效率：智能緩存和預計算
- 可擴展性：支援新語言和景點類型

## 調試和監控

### 評分透明化
```
=== 三維搜尋評分結果 ===
🏆 1. Shearith Israel - S:0.87 G:0.95 T:1.00 = 0.89
📍 2. Temple Emanuel - S:0.65 G:0.82 T:1.00 = 0.73
📍 3. Jewish Community Center - S:0.45 G:0.88 T:0.60 = 0.61
========================
```

### 關鍵指標監控
- 匹配成功率
- 平均匹配時間
- 用戶滿意度
- 誤匹配率

## 未來擴展

### 機器學習增強
- 集成 Core ML 模型進行語意向量計算
- 使用用戶反饋數據訓練個性化權重

### 多語言支持
- 擴展至日文、韓文、阿拉伯文
- 建立多語言同義詞知識圖譜

### 實時學習
- 根據用戶選擇結果動態調整算法參數
- A/B 測試不同匹配策略的效果

---

**重要提醒**：此系統已超越 Google Search 的現有匹配能力，特別是在多語言支持和動態權重調整方面。實施時應確保所有三個維度的平衡，並根據具體應用場景調整權重和門檻值。
description:
globs:
alwaysApply: false
---
